# 毎日のデータ更新処理刷新ツール

## 1. プロジェクト概要
既存の手動データ更新処理を自動化・効率化するためのPythonツールです。
多様な形式（CSV, TXT, Excel）のデータファイルを読み込み、SQLiteデータベースに一括で取り込みます。

## 2. プロジェクト構造
```
claude-test/
├── README.md                 # (このファイル) プロジェクトの概要、使い方
├── gemini.md                 # Gemini用の作業ToDoリスト
├── docs/                     # ドキュメント
│   └── progress.md           # データ取り込みの進捗状況
├── src/                      # ソースコード
│   ├── main.py               # メイン実行スクリプト
│   └── core/                 # コア機能モジュール
│       └── sqlite_manager.py # DB操作のコアロジック
├── config/                   # 設定ファイル (現在は未使用)
├── data/                     # データディレクトリ
│   ├── csv/                  # 入力データファイル
│   └── sqlite/               # 出力SQLiteデータベース
├── logs/                     # ログファイル
└── archive/                  # 古い資料やアーカイブ
```

## 3. 実行手順
1. **データ準備**: `data/csv` フォルダに、取り込みたいデータファイル（CSV, TXT, Excel）を配置します。
2. **優先順位指定**: `テキスト一覧.csv` に、処理したいファイル名と、データベースに作成するテーブル名を指定します。
3. **実行**: `src/main.py` を実行します。
   ```bash
   python src/main.py
   ```
4. **結果確認**:
   - `data/sqlite/main.db` にデータが取り込まれていることを確認します。
   - `logs/` フォルダに生成されるログで、処理の詳細を確認できます。

## 4. 主要モジュール
- **`src/main.py`**:
  - `テキスト一覧.csv` を読み込み、処理の順序を決定します。
  - `sqlite_manager`を呼び出して、ファイルの取り込み処理を実行します。
- **`src/core/sqlite_manager.py`**:
  - ファイル（CSV, TXT, Excel）のエンコーディングを自動判定します。
  - ファイルの区切り文字（カンマ, タブ, スペース）を判別します。
  - `pandas`を利用してデータを読み込み、SQLiteに高速で一括挿入します。

## 5. 今後の計画 (ToDo)
1. **`sqlite_manager.py`の改修**:
   - [ ] **済** 区切り文字の判定ロジックを強化し、多様なTXT/CSVファイルに対応させる。
2. **主キーの定義**:
   - [ ] `主キー.xlsx` の情報に基づき、各テーブルに主キー制約を追加する機能を実装する。
3. **テストコードの作成**:
   - [ ] `tests/` フォルダを作成し、単体テストを実装する。
