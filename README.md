# 毎日のデータ更新処理刷新ツール

## 1. プロジェクト概要
既存の手動データ更新処理を自動化・効率化するためのPythonツールです。
多様な形式（CSV, TXT, Excel）のデータファイルを読み込み、SQLiteデータベースに一括で取り込みます。

## 2. プロジェクト構造
```
claude-test/
├── README.md                 # (このファイル) プロジェクトの概要、使い方
├── gemini.md                 # Gemini用の作業ToDoリスト
├── docs/                     # ドキュメント
│   ├── progress.md           # データ取り込みの進捗状況
│   └── README_backup.md      # 以前のREADME.mdのバックアップ
├── src/                      # ソースコード
│   ├── main.py               # メイン実行スクリプト
│   └── core/                 # コア機能モジュール
│       └── sqlite_manager.py # DB操作のコアロジック
├── config/                   # 設定ファイル
├── data/                     # データディレクトリ
│   ├── csv/                  # 入力データファイル
│   └── sqlite/               # 出力SQLiteデータベース
├── logs/                     # ログファイル
└── archive/                  # 古い資料やアーカイブ
```

## 3. 実行手順
1. **データ準備**: `data/csv` フォルダに、取り込みたいデータファイル（CSV, TXT, Excel）を配置します。
2. **優先順位指定**: `テキスト一覧.csv` に、処理したいファイル名と、データベースに作成するテーブル名を指定します。
3. **実行**: `src/main.py` を実行します。
   ```bash
   python src/main.py
   ```
4. **結果確認**:
   - `data/sqlite/main.db` にデータが取り込まれていることを確認します。
   - `logs/` フォルダに生成されるログで、処理の詳細を確認できます。

## 4. 主要モジュール
- **`src/main.py`**:
  - `テキスト一覧.csv` を読み込み、処理の順序を決定します。
  - `sqlite_manager`を呼び出して、ファイルの取り込み処理を実行します。
- **`src/core/sqlite_manager.py`**:
  - ファイル（CSV, TXT, Excel）のエンコーディングを自動判定します。
  - ファイルの区切り文字（カンマ, タブ, スペース）を判別します。
  - `pandas`を利用してデータを読み込み、SQLiteに高速で一括挿入します。

## 5. 現在の進捗状況
- [x] **基本的なデータ取り込み機能**: CSV, TXT, Excelファイルの読み込み
- [x] **区切り文字の自動判定**: カンマ, タブ, スペース区切りに対応
- [x] **エンコーディング自動判定**: 文字化けを防ぐ自動判定機能
- [x] **SQLiteデータベースへの一括挿入**: 高速なデータ処理

## 6. 改善提案と今後の開発計画

### 🔧 コア機能の改善
1. **テーブル命名規則の標準化**
   - `sqlite_manager`モジュールでテーブル名の命名規則を統一
   - 全テーブル間での一貫性を確保し、将来の保守性を向上

2. **並列処理の実装**
   - 大容量データセットや複数ファイルの同時処理効率向上
   - マルチプロセシング・マルチスレッドによる高速化

3. **API仕様の実装**
   - 設計ガイドライン、エラーコード、リクエスト/レスポンス形式の標準化
   - 将来の開発における一貫性とスケーラビリティの確保

### 📊 監視・品質向上
4. **ログ・監視機能の強化**
   - パフォーマンスメトリクス追跡
   - トラブルシューティング機能の改善
   - 詳細なエラーログとデバッグ情報

5. **包括的なテスト実装**
   - 様々なユースケース、データセット、設定での動作検証
   - スケーラビリティと信頼性の確保
   - 自動テストスイートの構築

6. **エラーハンドリングの強化**
   - コードベースでのエラー処理改善
   - ユーザー入力・リクエストの検証機能
   - 品質向上とバグ予防

### 🔄 継続的改善
7. **継続的アップデート**
   - ユーザーフィードバックに基づく新機能追加
   - バグ修正と改善の継続的実装
   - 業界トレンドに対応した機能拡張

## 7. 短期実装可能な追加機能

### 🖥️ ユーザーインターフェース
- **APIページネーション**: 複数ファイル表示時のページ分割機能
- **GUI インターフェース**: Python + Tkinterによる直感的な操作画面
- **検索機能**: ファイル名や日付範囲による絞り込み検索

### 📤 データエクスポート機能
- **複数形式でのダウンロード**: CSV, JSON等での処理済みデータ出力
- **XLSX形式エクスポート**: Excelファイルでの保存機能
- **カスタムレポート生成**: 選択基準に基づくレポート作成

### 🔐 セキュリティ・共有機能
- **セキュアな共有環境**: 組織・部署内での安全なデータ共有
- **アクセス制御**: ユーザー権限管理機能

## 8. 技術的な今後の計画 (ToDo)

### 優先度: 高
- [ ] テーブル命名規則の標準化実装
- [ ] エラーハンドリングの強化
- [ ] 基本的なログ機能の拡充

### 優先度: 中
- [ ] 並列処理機能の実装
- [ ] API仕様の設計・実装
- [ ] テストコードの作成

### 優先度: 低
- [ ] GUI インターフェースの開発
- [ ] 高度な監視機能の実装
- [ ] セキュアな共有機能の実装

## 9. 従来のToDo (完了済み・進行中)
1. **`sqlite_manager.py`の改修**:
   - [x] **済** 区切り文字の判定ロジックを強化し、多様なTXT/CSVファイルに対応
2. **主キーの定義**:
   - [ ] `主キー.xlsx` の情報に基づき、各テーブルに主キー制約を追加する機能を実装
3. **テストコードの作成**:
   - [ ] `tests/` フォルダを作成し、単体テストを実装

## 10. 貢献とフィードバック
このプロジェクトは継続的に改善されています。新機能の提案、バグレポート、コードの改善案などのフィードバックを歓迎します。
